Tamarin allows protocol (and adversary) modeling through multiset rewriting rules.

\begin{definition}[Multiset rewriting rule]

Given a multiset $\Gamma_t = \{ F_0, ..., F_n \}$ and a sequence of multisets $trace_t = \langle a_0, ..., a_{t-1} \rangle$ at a time $t$, we can define a rewrite rule as a triple of multisets $RR = \langle L, A, R \rangle$ (written as $RR= L -[ A ] \rightarrow R$) such that:

\begin{itemize}
    \item we can apply $RR$ to $\Gamma_t$ if there is at least one ground instance (i.e. an instance with no variables) $rr = l -[ a ] \rightarrow r$ of $RR$ so that $l \subseteq^{\#} \Gamma_t$
    \item applying $rr$ to $\Gamma_t$ yields to a new state $\Gamma_{t+1}$ and an increased trace $trace_{t+1}$ obtained as

\begin{align}
    \Gamma_{t+1} &= \Gamma_t \setminus^{\#} l \cup^{\#} r \label{eq:StateEvolution}\\
    trace_{t+1} &= \langle a_0, ..., a_{t-1}, a_t \rangle
\end{align}

\end{itemize}

in which $\setminus^{\#}$ and $\cup^{\#}$ are the multiset equivalent operations for set difference and union. From now on, we will refer to $L$, $R$ and $A$ as the multisets of \textit{premises}, \textit{conclusions} and \textit{action facts} of a rule (in this order). 
\end{definition}

Note that within the trace $trace_{t+1}$, $a$ is associated to the time istant $t$: this will be useful later on since security properties will be specified through first order logic guarded formulas. To be precise, a \textit{trace} is the sequence of sets of ground (action) facts that happened during the execution of a series of rewriting rules.

More formally, given a set of rules $P$, all the possible traces generated by executions of P are

\begin{align*}
    traces(P) = \{ &\langle A_1,...,A_n \rangle | \exists S_1,...,S_n . \varnothing ^{\#} \xrightarrow[]{A_1} S_1 \xrightarrow[]{A_2} ... \xrightarrow[]{A_n} S_n\\
    & \textrm{and no ground istance of Fresh() is used twice }\}
\end{align*}

For the purpose of this thesis is also worth mentioning that since in a rewriting rule $L -[ A ] \rightarrow R$ any of the three multisets could be empty, a trace in which all istances of $\varnothing^{\#}$ are removed is called an \textit{observable trace}. 

Within Tamarin, all multisets are composed by facts. Facts feature a precise arity, are named with a starting capital letter and can be either \textit{linear} or \textit{persistent}:

\begin{itemize}
    \item linear facts can be consumed only once and are useful to model state transitions and ephemeral messages;
    \item persistent facts can be consumed unlimited times and are optimal to model enduring knowledge (and are prefixed by an exclamation mark). Note that the introduction of persistent facts requires a slight change to equation \ref{eq:StateEvolution}: whereas before all elements of $l$ were removed from $\Gamma_t$, now only the linear facts beloging to $l$ will be subtracted, while persistent facts will never be consumed.
\end{itemize}

In turn, facts are made up of terms, which can be public (prefixed by a \$), freshly created (prefixed by a \textasciitilde{}) or normal messages (note that public and fresh terms are sub-categories of normal messages).